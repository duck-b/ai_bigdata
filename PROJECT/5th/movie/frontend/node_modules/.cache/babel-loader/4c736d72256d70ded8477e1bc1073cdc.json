{"ast":null,"code":"import { Fragment as _Fragment } from \"react/jsx-dev-runtime\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\n\nvar _jsxFileName = \"/Users/jaehyeong/Documents/code/python-project/PROJECT/5th/movie/frontend/src/routes/pages/Main/MainPresenter.js\",\n    _s = $RefreshSig$();\n\nimport React, { useEffect, useState, useRef } from 'react';\nimport axios from 'axios';\nimport Cookies from 'js-cookie';\nimport { Link, useHistory, withRouter } from 'react-router-dom';\nimport { DropdownButton, Dropdown, Button, Card } from 'react-bootstrap'; // axios.defaults.xsrfHeaderName = \"X-CSRFTOKEN\";\n// axios.defaults.xsrfCookieName = \"XCSRF-TOKEN\";\n// axios.defaults.withCredentials = true\n\nconst MainPresenter = props => {\n  _s();\n\n  let [genre, genreChange] = useState(['공연실황', '드라마', '다큐멘터리', '애니메이션', '모험', '액션', 'SF', '멜로/로맨스', '전쟁', '범죄', '판타지', '서부', '한국', '뮤지컬', '공포', '미스터리', '스릴러', '서스펜스', '느와르', '서사']);\n  let history = useHistory();\n  const [movies, setMovies] = useState([{\n    \"movie_id\": 10001,\n    \"movie_title\": \"시네마 천국\",\n    \"movie_url\": \"https://movie.naver.com/movie/bi/mi/basic.naver?code=10001\",\n    \"movie_aud\": 9.63,\n    \"movie_net\": 9.33,\n    \"movie_rep\": 8.38,\n    \"movie_poster\": \"https://movie-phinf.pstatic.net/20210409_134/16179547654813MHq5_JPEG/movie_image.jpg?type=m203_290_2\",\n    \"movie_genre\": 2,\n    \"movie_country\": 10,\n    \"movie_runtime\": 124,\n    \"movie_release\": \"2020-04-22\",\n    \"movie_director\": \"쥬세페 토르나토레\",\n    \"movie_age\": 4,\n    \"movie_content\": \"어린 시절 영화가 세상의 전부였던 소년 토토는 학교 수업을 마치면 마을 광장에 있는 낡은 시네마 천국이라는 극장으로 달려가 영사 기사 알프레도와 친구로 지내며 어깨너머로 영사기술을 배운다. 어느 날 관객들을 위해 광장에서 야외 상영을 해주던 알프레도가 그만 화재 사고로 실명하게 되고 토토가 그의 뒤를 이어 시네마 천국의 영상기사로 일하게 된다. 실명한 후에도 토토의 친구이자 아버지로 든든한 정신적 지주가 되어준 알프레도는 청년이 된 토토가 사랑하는 여자 엘레나의 부모님의 반대로 좌절하자 넓은 세상으로 나가서 더 많은 것을 배우라며 권유하는데...\"\n  }]);\n  ;\n  useEffect(() => {\n    const loadMovies = async () => {\n      const config = {\n        headers: {\n          \"content-type\": \"application/json\"\n        }\n      };\n      await axios.get(`/api/`, config).then(response => {\n        //전체 영화데이터\n        // console.log(response.data)\n        setMovies(response.data);\n      });\n    };\n\n    loadMovies();\n  }, []);\n  const [checkedMovie, setCheckedMovie] = useState([]);\n\n  const handleClickImage = movie => {\n    if (checkedMovie.length < 3) {\n      let checked = false;\n      let i = 0;\n\n      for (i; i < checkedMovie.length; i++) {\n        if (checkedMovie[i].movie_id === movie.movie_id) {\n          checked = true;\n          break;\n        }\n      }\n\n      if (checked) {\n        const updateCheckedMovies = [...checkedMovie];\n        updateCheckedMovies.splice(i, 1);\n        setCheckedMovie(updateCheckedMovies);\n      } else {\n        const updateCheckedMovies = [...checkedMovie];\n        updateCheckedMovies.push(movie);\n        setCheckedMovie(updateCheckedMovies);\n      }\n    } else {\n      alert('3개까지만 선택 가능합니다!');\n    }\n  };\n\n  const handleClickCancle = i => {\n    const updateCheckedMovies = [...checkedMovie];\n    updateCheckedMovies.splice(i, 1);\n    setCheckedMovie(updateCheckedMovies);\n  };\n\n  const changeCate = name => {\n    if (name === '공연실황') return 1;else if (name === '드라마') return 2;else if (name === '다큐멘터리') return 3;else if (name === '애니메이션') return 4;else if (name === '모험') return 5;else if (name === '액션') return 6;else if (name === 'SF') return 7;else if (name === '멜로/로맨스') return 8;else if (name === '전쟁') return 9;else if (name === '범죄') return 10;else if (name === '판타지') return 11;else if (name === '가족') return 12;else if (name === '코미디') return 13;else if (name === '서부') return 14;else if (name === '한국') return 15;else if (name === '뮤지컬') return 16;else if (name === '공포') return 17;else if (name === '미스터리') return 18;else if (name === '스릴러') return 19;else if (name === '서스펜스') return 20;else if (name === '느와르') return 21;else if (name === '서사') return 22;\n  };\n\n  const [genreValue, SetGenreValue] = useState();\n\n  const FindGenreValue = (e, j) => {\n    SetGenreValue(changeCate(j));\n    setCheckedMovie([]);\n  };\n\n  const genreFilter = movies => {\n    const filterGenre = movies.filter(item => item.movie_genre == genreValue);\n    return filterGenre;\n  };\n\n  const [loading, setLoading] = useState(false);\n  const [searchMovie, setSearchMovie] = useState([]);\n\n  const handleClickSearch = async () => {\n    setLoading(true);\n\n    if (checkedMovie.length === 3 && genreValue) {\n      // const csrftoken = Cookies.get('csrftoken');\n      // const formData = new FormData();\n      // formData.append('movie_id1', checkedMovie[0].movie_id);\n      // formData.append('movie_id2', checkedMovie[1].movie_id);\n      // formData.append('movie_id3', checkedMovie[2].movie_id);\n      // formData.append('movie_genre', genreValue);\n      const config = {\n        headers: {\n          \"content-type\": \"application/json\" // \"xsrfHeaderName\": 'X-CSRFToken'\n\n        }\n      };\n      await axios.get(`/api/search/${genreValue}/${checkedMovie[0].movie_id}/${checkedMovie[1].movie_id}/${checkedMovie[2].movie_id}/`, config).then(response => {\n        //전체 영화데이터\n        setSearchMovie(response.data);\n        setTimeout(() => {\n          setLoading(false);\n        }, 2000);\n      });\n    }\n  };\n\n  const handleClickReset = () => {\n    setCheckedMovie([]);\n    setSearchMovie([]);\n  };\n\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"content\",\n    children: loading ? /*#__PURE__*/_jsxDEV(\"div\", {\n      children: \"Loading...\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 149,\n      columnNumber: 13\n    }, this) : searchMovie.length === 10 ? /*#__PURE__*/_jsxDEV(_Fragment, {\n      children: [/*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"recommendation\",\n        children: [/*#__PURE__*/_jsxDEV(\"h1\", {\n          children: \"\\uD68C\\uC6D0\\uB2D8\\uC5D0\\uAC8C \\uCD94\\uCC9C\\uB41C \\uC601\\uD654\\uC785\\uB2C8\\uB2E4.\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 156,\n          columnNumber: 17\n        }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n          children: [\"\\uD68C\\uC6D0\\uB2D8\\uC774 \\uC88B\\uC544\\uD558\\uC2E4 \\uB9CC\\uD55C \\uC601\\uD654\\uB97C \\uB354 \\uB9CE\\uC774 \\uCD94\\uCC9C\\uD574\\uB4DC\\uB9B4 \\uC218 \\uC788\\uC2B5\\uB2C8\\uB2E4. \", /*#__PURE__*/_jsxDEV(Link, {\n            onClick: handleClickReset,\n            children: \"\\uB2E4\\uC2DC \\uC120\\uD0DD\\uD558\\uAE30\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 157,\n            columnNumber: 56\n          }, this), /*#__PURE__*/_jsxDEV(\"br\", {}, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 157,\n            columnNumber: 103\n          }, this), /*#__PURE__*/_jsxDEV(Link, {\n            to: '/search',\n            children: \" \\uC54C\\uC544\\uC11C \\uBCFC\\uAC8C\\uC694!! < Click\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 157,\n            columnNumber: 108\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 157,\n          columnNumber: 17\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 155,\n        columnNumber: 13\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"movieposter\",\n        children: searchMovie.map((movie, i) => {\n          return /*#__PURE__*/_jsxDEV(Link, {\n            to: '/' + movie.movie_id,\n            children: /*#__PURE__*/_jsxDEV(\"img\", {\n              className: \"img-responsive2\",\n              src: movie.movie_poster,\n              alt: \"\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 162,\n              columnNumber: 51\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 162,\n            columnNumber: 21\n          }, this);\n        })\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 159,\n        columnNumber: 13\n      }, this)]\n    }, void 0, true) : /*#__PURE__*/_jsxDEV(_Fragment, {\n      children: [/*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"goBack\",\n        children: /*#__PURE__*/_jsxDEV(\"img\", {\n          onClick: () => {\n            history.goBack();\n          },\n          src: \"img/back.svg\",\n          alt: \"\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 169,\n          columnNumber: 37\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 169,\n        columnNumber: 13\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"recommendation\",\n        children: [/*#__PURE__*/_jsxDEV(\"h1\", {\n          children: \"\\uC88B\\uC544\\uD558\\uB294 \\uCF58\\uD150\\uCE20\\uB97C 3\\uAC1C \\uC120\\uD0DD\\uD558\\uC138\\uC694!\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 171,\n          columnNumber: 17\n        }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n          children: [\"\\uD68C\\uC6D0\\uB2D8\\uC774 \\uC88B\\uC544\\uD558\\uC2E4 \\uB9CC\\uD55C \\uC601\\uD654\\uB97C \\uB354 \\uB9CE\\uC774 \\uCD94\\uCC9C\\uD574\\uB4DC\\uB9B4 \\uC218 \\uC788\\uC2B5\\uB2C8\\uB2E4. \\uB9C8\\uC74C\\uC5D0 \\uB4DC\\uB294 \\uCF58\\uD150\\uCE20\\uB97C \\uC120\\uD0DD\\uD558\\uC138\\uC694.\", /*#__PURE__*/_jsxDEV(\"br\", {}, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 172,\n            columnNumber: 74\n          }, this), /*#__PURE__*/_jsxDEV(Link, {\n            to: '/search',\n            children: \" \\uC54C\\uC544\\uC11C \\uBCFC\\uAC8C\\uC694!! < Click\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 172,\n            columnNumber: 79\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 172,\n          columnNumber: 17\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 170,\n        columnNumber: 13\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"movie-list\",\n        children: [/*#__PURE__*/_jsxDEV(DropdownButton, {\n          id: \"dropdown-item-button\",\n          title: genreValue ? genre[genreValue - 1] : \"장르를 선택하세요\",\n          children: genre.map(function (j) {\n            return /*#__PURE__*/_jsxDEV(Link, {\n              children: /*#__PURE__*/_jsxDEV(Dropdown.Item, {\n                onClick: e => {\n                  FindGenreValue(e, j);\n                },\n                children: j\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 177,\n                columnNumber: 38\n              }, this)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 177,\n              columnNumber: 32\n            }, this);\n          })\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 175,\n          columnNumber: 17\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"row ml-0 mt-1 mb-1\",\n          children: checkedMovie.map((movie, i) => /*#__PURE__*/_jsxDEV(Card, {\n            style: {\n              width: '33.3%',\n              display: 'inline-block'\n            },\n            children: [/*#__PURE__*/_jsxDEV(Card.Img, {\n              variant: \"top\",\n              src: movie.movie_poster,\n              height: \"200px\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 183,\n              columnNumber: 29\n            }, this), /*#__PURE__*/_jsxDEV(Card.Body, {\n              children: [/*#__PURE__*/_jsxDEV(Card.Title, {\n                children: movie.movie_title\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 185,\n                columnNumber: 33\n              }, this), /*#__PURE__*/_jsxDEV(Card.Text, {\n                children: [movie.movie_content.substr(0, 90), movie.movie_content.length > 90 ? '...' : '']\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 186,\n                columnNumber: 33\n              }, this), /*#__PURE__*/_jsxDEV(Button, {\n                variant: \"outline-primary\",\n                className: \"mr-1\",\n                onClick: () => props.history.push('/' + movie.movie_id),\n                children: \"\\uBC14\\uB85C\\uBCF4\\uAE30\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 190,\n                columnNumber: 33\n              }, this), /*#__PURE__*/_jsxDEV(Button, {\n                variant: \"outline-danger\",\n                onClick: () => handleClickCancle(i),\n                children: \"\\uC120\\uD0DD\\uCDE8\\uC18C\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 191,\n                columnNumber: 33\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 184,\n              columnNumber: 29\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 182,\n            columnNumber: 25\n          }, this))\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 180,\n          columnNumber: 17\n        }, this), checkedMovie.length === 3 ? /*#__PURE__*/_jsxDEV(\"button\", {\n          className: \"btn clickrecomm\",\n          onClick: handleClickSearch,\n          children: \"\\uB0B4 \\uCDE8\\uD5A5\\uC5D0 \\uB9DE\\uAC8C \\uCD94\\uCC9C\\uBC1B\\uAE30!\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 197,\n          columnNumber: 17\n        }, this) : /*#__PURE__*/_jsxDEV(\"button\", {\n          className: \"btn clickrecomm_disable disable\",\n          onClick: () => alert('영화 ' + (3 - checkedMovie.length) + '개를 더 선택해야합니다.'),\n          children: \"\\uB0B4 \\uCDE8\\uD5A5\\uC5D0 \\uB9DE\\uAC8C \\uCD94\\uCC9C\\uBC1B\\uAE30!\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 198,\n          columnNumber: 17\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"row\",\n          children: /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"movieposter\",\n            children: genreFilter(movies).map((movie, i) => /*#__PURE__*/_jsxDEV(\"img\", {\n              className: \"img-responsive\",\n              src: movie.movie_poster,\n              alt: i,\n              onClick: () => {\n                handleClickImage(movie);\n              }\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 203,\n              columnNumber: 29\n            }, this))\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 201,\n            columnNumber: 21\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 200,\n          columnNumber: 17\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 174,\n        columnNumber: 13\n      }, this)]\n    }, void 0, true)\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 147,\n    columnNumber: 9\n  }, this);\n};\n\n_s(MainPresenter, \"rKbQQ3234lRwox+4Wja8K4IWto0=\", false, function () {\n  return [useHistory];\n});\n\n_c = MainPresenter;\nexport default _c2 = withRouter(MainPresenter);\n\nvar _c, _c2;\n\n$RefreshReg$(_c, \"MainPresenter\");\n$RefreshReg$(_c2, \"%default%\");","map":{"version":3,"sources":["/Users/jaehyeong/Documents/code/python-project/PROJECT/5th/movie/frontend/src/routes/pages/Main/MainPresenter.js"],"names":["React","useEffect","useState","useRef","axios","Cookies","Link","useHistory","withRouter","DropdownButton","Dropdown","Button","Card","MainPresenter","props","genre","genreChange","history","movies","setMovies","loadMovies","config","headers","get","then","response","data","checkedMovie","setCheckedMovie","handleClickImage","movie","length","checked","i","movie_id","updateCheckedMovies","splice","push","alert","handleClickCancle","changeCate","name","genreValue","SetGenreValue","FindGenreValue","e","j","genreFilter","filterGenre","filter","item","movie_genre","loading","setLoading","searchMovie","setSearchMovie","handleClickSearch","setTimeout","handleClickReset","map","movie_poster","goBack","width","display","movie_title","movie_content","substr"],"mappings":";;;;;;AAAA,OAAOA,KAAP,IAAgBC,SAAhB,EAA2BC,QAA3B,EAAqCC,MAArC,QAAmD,OAAnD;AACA,OAAOC,KAAP,MAAkB,OAAlB;AACA,OAAOC,OAAP,MAAoB,WAApB;AAEA,SAASC,IAAT,EAAeC,UAAf,EAA2BC,UAA3B,QAA6C,kBAA7C;AACA,SAAQC,cAAR,EAAwBC,QAAxB,EAAkCC,MAAlC,EAA0CC,IAA1C,QAAqD,iBAArD,C,CAGA;AACA;AACA;;AAEA,MAAMC,aAAa,GAAIC,KAAD,IAAW;AAAA;;AAC/B,MAAI,CAACC,KAAD,EAAQC,WAAR,IAAqBd,QAAQ,CAAC,CAAC,MAAD,EAAS,KAAT,EAAgB,OAAhB,EAAyB,OAAzB,EAAkC,IAAlC,EAAwC,IAAxC,EAA8C,IAA9C,EAAoD,QAApD,EAA8D,IAA9D,EAAoE,IAApE,EAA0E,KAA1E,EAAiF,IAAjF,EAAuF,IAAvF,EAA6F,KAA7F,EAAoG,IAApG,EAA0G,MAA1G,EAAkH,KAAlH,EAA0H,MAA1H,EAAkI,KAAlI,EAAyI,IAAzI,CAAD,CAAjC;AAEE,MAAIe,OAAO,GAAGV,UAAU,EAAxB;AACA,QAAM,CAACW,MAAD,EAASC,SAAT,IAAsBjB,QAAQ,CAAC,CACjC;AACE,gBAAY,KADd;AAEE,mBAAe,QAFjB;AAGE,iBAAa,4DAHf;AAIE,iBAAa,IAJf;AAKE,iBAAa,IALf;AAME,iBAAa,IANf;AAOE,oBAAgB,sGAPlB;AAQE,mBAAe,CARjB;AASE,qBAAiB,EATnB;AAUE,qBAAiB,GAVnB;AAWE,qBAAiB,YAXnB;AAYE,sBAAkB,WAZpB;AAaE,iBAAa,CAbf;AAcE,qBAAiB;AAdnB,GADiC,CAAD,CAApC;AAkBA;AACAD,EAAAA,SAAS,CAAC,MAAM;AACZ,UAAMmB,UAAU,GAAG,YAAW;AAC1B,YAAMC,MAAM,GAAG;AACXC,QAAAA,OAAO,EAAE;AACL,0BAAgB;AADX;AADE,OAAf;AAKA,YAAMlB,KAAK,CAACmB,GAAN,CAAW,OAAX,EAAmBF,MAAnB,EAA2BG,IAA3B,CAAiCC,QAAD,IAAY;AAAC;AAC/C;AACAN,QAAAA,SAAS,CAACM,QAAQ,CAACC,IAAV,CAAT;AACH,OAHK,CAAN;AAIH,KAVD;;AAWAN,IAAAA,UAAU;AACX,GAbM,EAaJ,EAbI,CAAT;AAcA,QAAM,CAACO,YAAD,EAAeC,eAAf,IAAkC1B,QAAQ,CAAC,EAAD,CAAhD;;AACA,QAAM2B,gBAAgB,GAAIC,KAAD,IAAW;AAChC,QAAIH,YAAY,CAACI,MAAb,GAAsB,CAA1B,EAA4B;AACxB,UAAIC,OAAO,GAAG,KAAd;AACA,UAAIC,CAAC,GAAG,CAAR;;AACA,WAAIA,CAAJ,EAAOA,CAAC,GAAGN,YAAY,CAACI,MAAxB,EAAgCE,CAAC,EAAjC,EAAoC;AAChC,YAAGN,YAAY,CAACM,CAAD,CAAZ,CAAgBC,QAAhB,KAA6BJ,KAAK,CAACI,QAAtC,EAA+C;AAC3CF,UAAAA,OAAO,GAAG,IAAV;AACA;AACH;AACJ;;AACD,UAAGA,OAAH,EAAW;AACP,cAAMG,mBAAmB,GAAG,CAAC,GAAGR,YAAJ,CAA5B;AACAQ,QAAAA,mBAAmB,CAACC,MAApB,CAA2BH,CAA3B,EAA8B,CAA9B;AACAL,QAAAA,eAAe,CAACO,mBAAD,CAAf;AACH,OAJD,MAIK;AACD,cAAMA,mBAAmB,GAAG,CAAC,GAAGR,YAAJ,CAA5B;AACAQ,QAAAA,mBAAmB,CAACE,IAApB,CAAyBP,KAAzB;AACAF,QAAAA,eAAe,CAACO,mBAAD,CAAf;AACH;AACJ,KAlBD,MAkBK;AACDG,MAAAA,KAAK,CAAC,iBAAD,CAAL;AACH;AACJ,GAtBD;;AAuBA,QAAMC,iBAAiB,GAAIN,CAAD,IAAO;AAC7B,UAAME,mBAAmB,GAAG,CAAC,GAAGR,YAAJ,CAA5B;AACAQ,IAAAA,mBAAmB,CAACC,MAApB,CAA2BH,CAA3B,EAA8B,CAA9B;AACAL,IAAAA,eAAe,CAACO,mBAAD,CAAf;AACH,GAJD;;AAMA,QAAMK,UAAU,GAAGC,IAAF,IAAU;AACvB,QAAIA,IAAI,KAAK,MAAb,EAAqB,OAAO,CAAP,CAArB,KACK,IAAIA,IAAI,KAAK,KAAb,EAAoB,OAAO,CAAP,CAApB,KACA,IAAIA,IAAI,KAAK,OAAb,EAAsB,OAAO,CAAP,CAAtB,KACA,IAAIA,IAAI,KAAK,OAAb,EAAsB,OAAO,CAAP,CAAtB,KACA,IAAIA,IAAI,KAAK,IAAb,EAAmB,OAAO,CAAP,CAAnB,KACA,IAAIA,IAAI,KAAK,IAAb,EAAmB,OAAO,CAAP,CAAnB,KACA,IAAIA,IAAI,KAAK,IAAb,EAAmB,OAAO,CAAP,CAAnB,KACA,IAAIA,IAAI,KAAK,QAAb,EAAuB,OAAO,CAAP,CAAvB,KACA,IAAIA,IAAI,KAAK,IAAb,EAAmB,OAAO,CAAP,CAAnB,KACA,IAAIA,IAAI,KAAK,IAAb,EAAmB,OAAO,EAAP,CAAnB,KACA,IAAIA,IAAI,KAAK,KAAb,EAAoB,OAAO,EAAP,CAApB,KACA,IAAIA,IAAI,KAAK,IAAb,EAAmB,OAAO,EAAP,CAAnB,KACA,IAAIA,IAAI,KAAK,KAAb,EAAoB,OAAO,EAAP,CAApB,KACA,IAAIA,IAAI,KAAK,IAAb,EAAmB,OAAO,EAAP,CAAnB,KACA,IAAIA,IAAI,KAAK,IAAb,EAAmB,OAAO,EAAP,CAAnB,KACA,IAAIA,IAAI,KAAK,KAAb,EAAoB,OAAO,EAAP,CAApB,KACA,IAAIA,IAAI,KAAK,IAAb,EAAmB,OAAO,EAAP,CAAnB,KACA,IAAIA,IAAI,KAAK,MAAb,EAAqB,OAAO,EAAP,CAArB,KACA,IAAIA,IAAI,KAAK,KAAb,EAAoB,OAAO,EAAP,CAApB,KACA,IAAIA,IAAI,KAAK,MAAb,EAAqB,OAAO,EAAP,CAArB,KACA,IAAIA,IAAI,KAAK,KAAb,EAAoB,OAAO,EAAP,CAApB,KACA,IAAIA,IAAI,KAAK,IAAb,EAAmB,OAAO,EAAP;AAC3B,GAvBD;;AAwBA,QAAM,CAACC,UAAD,EAAaC,aAAb,IAA8BzC,QAAQ,EAA5C;;AAEA,QAAM0C,cAAc,GAAE,CAACC,CAAD,EAAGC,CAAH,KAAQ;AAC1BH,IAAAA,aAAa,CAACH,UAAU,CAACM,CAAD,CAAX,CAAb;AACAlB,IAAAA,eAAe,CAAC,EAAD,CAAf;AACH,GAHD;;AAKA,QAAMmB,WAAW,GAAI7B,MAAD,IAAW;AAC3B,UAAM8B,WAAW,GAAG9B,MAAM,CAAC+B,MAAP,CAAeC,IAAD,IAASA,IAAI,CAACC,WAAL,IAAoBT,UAA3C,CAApB;AACA,WAAOM,WAAP;AACH,GAHD;;AAIA,QAAM,CAACI,OAAD,EAAUC,UAAV,IAAwBnD,QAAQ,CAAC,KAAD,CAAtC;AACA,QAAM,CAACoD,WAAD,EAAcC,cAAd,IAAgCrD,QAAQ,CAAC,EAAD,CAA9C;;AAEA,QAAMsD,iBAAiB,GAAG,YAAW;AACjCH,IAAAA,UAAU,CAAC,IAAD,CAAV;;AACA,QAAG1B,YAAY,CAACI,MAAb,KAAsB,CAAtB,IAA2BW,UAA9B,EAAyC;AACrC;AAEA;AACA;AACA;AACA;AACA;AACA,YAAMrB,MAAM,GAAG;AACXC,QAAAA,OAAO,EAAE;AACL,0BAAgB,kBADX,CAEL;;AAFK;AADE,OAAf;AAMA,YAAMlB,KAAK,CAACmB,GAAN,CAAW,eAAcmB,UAAW,IAAGf,YAAY,CAAC,CAAD,CAAZ,CAAgBO,QAAS,IAAGP,YAAY,CAAC,CAAD,CAAZ,CAAgBO,QAAS,IAAGP,YAAY,CAAC,CAAD,CAAZ,CAAgBO,QAAS,GAAxH,EAA4Hb,MAA5H,EAAoIG,IAApI,CAA0IC,QAAD,IAAY;AAAC;AACxJ8B,QAAAA,cAAc,CAAC9B,QAAQ,CAACC,IAAV,CAAd;AACA+B,QAAAA,UAAU,CAAC,MAAM;AACbJ,UAAAA,UAAU,CAAC,KAAD,CAAV;AACH,SAFS,EAEP,IAFO,CAAV;AAGH,OALK,CAAN;AAMH;AACJ,GAvBD;;AAwBA,QAAMK,gBAAgB,GAAG,MAAM;AAC3B9B,IAAAA,eAAe,CAAC,EAAD,CAAf;AACA2B,IAAAA,cAAc,CAAC,EAAD,CAAd;AACH,GAHD;;AAIA,sBACI;AAAK,IAAA,SAAS,EAAC,SAAf;AAAA,cACKH,OAAO,gBACR;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,YADQ,GAKRE,WAAW,CAACvB,MAAZ,KAAuB,EAAvB,gBACA;AAAA,8BACA;AAAK,QAAA,SAAS,EAAC,gBAAf;AAAA,gCACI;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,gBADJ,eAEI;AAAA,4MAAuC,QAAC,IAAD;AAAM,YAAA,OAAO,EAAE2B,gBAAf;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,kBAAvC,eAAsF;AAAA;AAAA;AAAA;AAAA,kBAAtF,eAA2F,QAAC,IAAD;AAAM,YAAA,EAAE,EAAE,SAAV;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,kBAA3F;AAAA;AAAA;AAAA;AAAA;AAAA,gBAFJ;AAAA;AAAA;AAAA;AAAA;AAAA,cADA,eAKA;AAAK,QAAA,SAAS,EAAC,aAAf;AAAA,kBACCJ,WAAW,CAACK,GAAZ,CAAgB,CAAC7B,KAAD,EAAOG,CAAP,KAAW;AACxB,8BACI,QAAC,IAAD;AAAM,YAAA,EAAE,EAAE,MAAIH,KAAK,CAACI,QAApB;AAAA,mCAA8B;AAAK,cAAA,SAAS,EAAC,iBAAf;AAAiC,cAAA,GAAG,EAAEJ,KAAK,CAAC8B,YAA5C;AAA0D,cAAA,GAAG,EAAC;AAA9D;AAAA;AAAA;AAAA;AAAA;AAA9B;AAAA;AAAA;AAAA;AAAA,kBADJ;AAGH,SAJA;AADD;AAAA;AAAA;AAAA;AAAA,cALA;AAAA,oBADA,gBAeA;AAAA,8BACA;AAAK,QAAA,SAAS,EAAC,QAAf;AAAA,+BAAwB;AAAK,UAAA,OAAO,EAAE,MAAI;AAAE3C,YAAAA,OAAO,CAAC4C,MAAR;AAAmB,WAAvC;AAAyC,UAAA,GAAG,EAAC,cAA7C;AAA4D,UAAA,GAAG,EAAC;AAAhE;AAAA;AAAA;AAAA;AAAA;AAAxB;AAAA;AAAA;AAAA;AAAA,cADA,eAEA;AAAK,QAAA,SAAS,EAAC,gBAAf;AAAA,gCACI;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,gBADJ,eAEI;AAAA,oSAAyD;AAAA;AAAA;AAAA;AAAA,kBAAzD,eAA8D,QAAC,IAAD;AAAM,YAAA,EAAE,EAAE,SAAV;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,kBAA9D;AAAA;AAAA;AAAA;AAAA;AAAA,gBAFJ;AAAA;AAAA;AAAA;AAAA;AAAA,cAFA,eAMA;AAAK,QAAA,SAAS,EAAC,YAAf;AAAA,gCACI,QAAC,cAAD;AAAgB,UAAA,EAAE,EAAC,sBAAnB;AAA0C,UAAA,KAAK,EAAEnB,UAAU,GAAG3B,KAAK,CAAC2B,UAAU,GAAC,CAAZ,CAAR,GAAwB,WAAnF;AAAA,oBACK3B,KAAK,CAAC4C,GAAN,CAAU,UAASb,CAAT,EAAW;AAClB,gCAAO,QAAC,IAAD;AAAA,qCAAM,QAAC,QAAD,CAAU,IAAV;AAAe,gBAAA,OAAO,EAAGD,CAAD,IAAK;AAACD,kBAAAA,cAAc,CAACC,CAAD,EAAGC,CAAH,CAAd;AAAoB,iBAAlD;AAAA,0BAAqDA;AAArD;AAAA;AAAA;AAAA;AAAA;AAAN;AAAA;AAAA;AAAA;AAAA,oBAAP;AACH,WAFA;AADL;AAAA;AAAA;AAAA;AAAA,gBADJ,eAMI;AAAK,UAAA,SAAS,EAAC,oBAAf;AAAA,oBACKnB,YAAY,CAACgC,GAAb,CAAiB,CAAC7B,KAAD,EAAQG,CAAR,kBACd,QAAC,IAAD;AAAM,YAAA,KAAK,EAAE;AAAE6B,cAAAA,KAAK,EAAE,OAAT;AAAkBC,cAAAA,OAAO,EAAE;AAA3B,aAAb;AAAA,oCACI,QAAC,IAAD,CAAM,GAAN;AAAU,cAAA,OAAO,EAAC,KAAlB;AAAwB,cAAA,GAAG,EAAEjC,KAAK,CAAC8B,YAAnC;AAAiD,cAAA,MAAM,EAAC;AAAxD;AAAA;AAAA;AAAA;AAAA,oBADJ,eAEI,QAAC,IAAD,CAAM,IAAN;AAAA,sCACI,QAAC,IAAD,CAAM,KAAN;AAAA,0BAAa9B,KAAK,CAACkC;AAAnB;AAAA;AAAA;AAAA;AAAA,sBADJ,eAEI,QAAC,IAAD,CAAM,IAAN;AAAA,2BACKlC,KAAK,CAACmC,aAAN,CAAoBC,MAApB,CAA2B,CAA3B,EAA8B,EAA9B,CADL,EAEKpC,KAAK,CAACmC,aAAN,CAAoBlC,MAApB,GAA6B,EAA7B,GAAkC,KAAlC,GAA0C,EAF/C;AAAA;AAAA;AAAA;AAAA;AAAA,sBAFJ,eAMI,QAAC,MAAD;AAAQ,gBAAA,OAAO,EAAC,iBAAhB;AAAkC,gBAAA,SAAS,EAAC,MAA5C;AAAmD,gBAAA,OAAO,EAAE,MAAMjB,KAAK,CAACG,OAAN,CAAcoB,IAAd,CAAmB,MAAIP,KAAK,CAACI,QAA7B,CAAlE;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,sBANJ,eAOI,QAAC,MAAD;AAAQ,gBAAA,OAAO,EAAC,gBAAhB;AAAiC,gBAAA,OAAO,EAAE,MAAMK,iBAAiB,CAACN,CAAD,CAAjE;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,sBAPJ;AAAA;AAAA;AAAA;AAAA;AAAA,oBAFJ;AAAA;AAAA;AAAA;AAAA;AAAA,kBADH;AADL;AAAA;AAAA;AAAA;AAAA,gBANJ,EAsBKN,YAAY,CAACI,MAAb,KAAwB,CAAxB,gBACD;AAAQ,UAAA,SAAS,EAAC,iBAAlB;AAAoC,UAAA,OAAO,EAAEyB,iBAA7C;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,gBADC,gBAED;AAAQ,UAAA,SAAS,EAAC,iCAAlB;AAAoD,UAAA,OAAO,EAAE,MAAMlB,KAAK,CAAC,SAAO,IAAEX,YAAY,CAACI,MAAtB,IAA8B,eAA/B,CAAxE;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,gBAxBJ,eA0BI;AAAK,UAAA,SAAS,EAAC,KAAf;AAAA,iCACI;AAAK,YAAA,SAAS,EAAC,aAAf;AAAA,sBACKgB,WAAW,CAAC7B,MAAD,CAAX,CAAoByC,GAApB,CAAwB,CAAC7B,KAAD,EAAQG,CAAR,kBACrB;AAAK,cAAA,SAAS,EAAC,gBAAf;AAAgC,cAAA,GAAG,EAAEH,KAAK,CAAC8B,YAA3C;AAAyD,cAAA,GAAG,EAAE3B,CAA9D;AAAiE,cAAA,OAAO,EAAE,MAAM;AAAEJ,gBAAAA,gBAAgB,CAACC,KAAD,CAAhB;AAA0B;AAA5G;AAAA;AAAA;AAAA;AAAA,oBADH;AADL;AAAA;AAAA;AAAA;AAAA;AADJ;AAAA;AAAA;AAAA;AAAA,gBA1BJ;AAAA;AAAA;AAAA;AAAA;AAAA,cANA;AAAA;AArBJ;AAAA;AAAA;AAAA;AAAA,UADJ;AAkEH,CAvMD;;GAAMjB,a;UAGYN,U;;;KAHZM,a;AAyMN,qBAAeL,UAAU,CAACK,aAAD,CAAzB","sourcesContent":["import React, { useEffect, useState, useRef } from 'react';\nimport axios from 'axios';\nimport Cookies from 'js-cookie';\n\nimport { Link, useHistory, withRouter } from 'react-router-dom';\nimport {DropdownButton, Dropdown, Button, Card} from 'react-bootstrap';\n\n\n// axios.defaults.xsrfHeaderName = \"X-CSRFTOKEN\";\n// axios.defaults.xsrfCookieName = \"XCSRF-TOKEN\";\n// axios.defaults.withCredentials = true\n\nconst MainPresenter = (props) => {\n  let [genre, genreChange]=useState(['공연실황', '드라마', '다큐멘터리', '애니메이션', '모험', '액션', 'SF', '멜로/로맨스', '전쟁', '범죄', '판타지', '서부', '한국', '뮤지컬', '공포', '미스터리', '스릴러' , '서스펜스', '느와르', '서사'])\n\n    let history = useHistory();\n    const [movies, setMovies] = useState([\n        {\n          \"movie_id\": 10001,\n          \"movie_title\": \"시네마 천국\",\n          \"movie_url\": \"https://movie.naver.com/movie/bi/mi/basic.naver?code=10001\",\n          \"movie_aud\": 9.63,\n          \"movie_net\": 9.33,\n          \"movie_rep\": 8.38,\n          \"movie_poster\": \"https://movie-phinf.pstatic.net/20210409_134/16179547654813MHq5_JPEG/movie_image.jpg?type=m203_290_2\",\n          \"movie_genre\": 2,\n          \"movie_country\": 10,\n          \"movie_runtime\": 124,\n          \"movie_release\": \"2020-04-22\",\n          \"movie_director\": \"쥬세페 토르나토레\",\n          \"movie_age\": 4,\n          \"movie_content\": \"어린 시절 영화가 세상의 전부였던 소년 토토는 학교 수업을 마치면 마을 광장에 있는 낡은 시네마 천국이라는 극장으로 달려가 영사 기사 알프레도와 친구로 지내며 어깨너머로 영사기술을 배운다. 어느 날 관객들을 위해 광장에서 야외 상영을 해주던 알프레도가 그만 화재 사고로 실명하게 되고 토토가 그의 뒤를 이어 시네마 천국의 영상기사로 일하게 된다. 실명한 후에도 토토의 친구이자 아버지로 든든한 정신적 지주가 되어준 알프레도는 청년이 된 토토가 사랑하는 여자 엘레나의 부모님의 반대로 좌절하자 넓은 세상으로 나가서 더 많은 것을 배우라며 권유하는데...\"\n        }\n      ]);\n    ;\n    useEffect(() => {\n        const loadMovies = async() => {\n            const config = {\n                headers: {\n                    \"content-type\": \"application/json\"\n                }\n            };\n            await axios.get(`/api/`, config).then((response)=>{//전체 영화데이터\n                // console.log(response.data)\n                setMovies(response.data)\n            }); \n        }\n        loadMovies();\n      }, []);\n    const [checkedMovie, setCheckedMovie] = useState([])\n    const handleClickImage = (movie) => {\n        if (checkedMovie.length < 3){\n            let checked = false;\n            let i = 0;\n            for(i; i < checkedMovie.length; i++){\n                if(checkedMovie[i].movie_id === movie.movie_id){\n                    checked = true;\n                    break;\n                }\n            }\n            if(checked){\n                const updateCheckedMovies = [...checkedMovie]\n                updateCheckedMovies.splice(i, 1)\n                setCheckedMovie(updateCheckedMovies)\n            }else{\n                const updateCheckedMovies = [...checkedMovie]\n                updateCheckedMovies.push(movie)\n                setCheckedMovie(updateCheckedMovies)\n            }\n        }else{\n            alert('3개까지만 선택 가능합니다!')\n        }\n    }\n    const handleClickCancle = (i) => {\n        const updateCheckedMovies = [...checkedMovie]\n        updateCheckedMovies.splice(i, 1)\n        setCheckedMovie(updateCheckedMovies)\n    }\n \n    const changeCate=( name )=>{\n        if( name === '공연실황') return 1\n        else if( name === '드라마') return 2\n        else if( name === '다큐멘터리') return 3\n        else if( name === '애니메이션') return 4\n        else if( name === '모험') return 5\n        else if( name === '액션') return 6\n        else if( name === 'SF') return 7\n        else if( name === '멜로/로맨스') return 8\n        else if( name === '전쟁') return 9\n        else if( name === '범죄') return 10\n        else if( name === '판타지') return 11\n        else if( name === '가족') return 12\n        else if( name === '코미디') return 13\n        else if( name === '서부') return 14\n        else if( name === '한국') return 15\n        else if( name === '뮤지컬') return 16\n        else if( name === '공포') return 17\n        else if( name === '미스터리') return 18\n        else if( name === '스릴러') return 19\n        else if( name === '서스펜스') return 20\n        else if( name === '느와르') return 21\n        else if( name === '서사') return 22\n    }\n    const [genreValue, SetGenreValue] = useState();\n    \n    const FindGenreValue= (e,j) =>{\n        SetGenreValue(changeCate(j))\n        setCheckedMovie([])\n    }\n\n    const genreFilter = (movies) =>{\n        const filterGenre = movies.filter((item)=> item.movie_genre == genreValue)\n        return filterGenre\n    }\n    const [loading, setLoading] = useState(false);\n    const [searchMovie, setSearchMovie] = useState([]);\n\n    const handleClickSearch = async() => {\n        setLoading(true)\n        if(checkedMovie.length===3 && genreValue){\n            // const csrftoken = Cookies.get('csrftoken');\n            \n            // const formData = new FormData();\n            // formData.append('movie_id1', checkedMovie[0].movie_id);\n            // formData.append('movie_id2', checkedMovie[1].movie_id);\n            // formData.append('movie_id3', checkedMovie[2].movie_id);\n            // formData.append('movie_genre', genreValue);\n            const config = {\n                headers: {\n                    \"content-type\": \"application/json\",\n                    // \"xsrfHeaderName\": 'X-CSRFToken'\n                }\n            };\n            await axios.get(`/api/search/${genreValue}/${checkedMovie[0].movie_id}/${checkedMovie[1].movie_id}/${checkedMovie[2].movie_id}/`, config).then((response)=>{//전체 영화데이터\n                setSearchMovie(response.data)\n                setTimeout(() => {\n                    setLoading(false)\n                }, 2000)\n            }); \n        }\n    }\n    const handleClickReset = () => {\n        setCheckedMovie([])\n        setSearchMovie([])\n    }\n    return(\n        <div className='content'>\n            {loading?\n            <div>\n                Loading...\n            </div>\n            :\n            searchMovie.length === 10?\n            <>\n            <div className='recommendation'>\n                <h1>회원님에게 추천된 영화입니다.</h1>\n                <p>회원님이 좋아하실 만한 영화를 더 많이 추천해드릴 수 있습니다. <Link onClick={handleClickReset}>다시 선택하기</Link><br/><Link to={'/search'}> 알아서 볼게요!! &lt; Click</Link></p>\n            </div>\n            <div className='movieposter'>\n            {searchMovie.map((movie,i)=>{\n                return(\n                    <Link to={'/'+movie.movie_id}><img className='img-responsive2' src={movie.movie_poster} alt=\"\" /></Link>\n                )\n            })}\n            </div>\n            </>\n            :\n            <>\n            <div className='goBack'><img onClick={()=>{ history.goBack(); }} src=\"img/back.svg\" alt=\"\" /></div>\n            <div className='recommendation'>\n                <h1>좋아하는 콘텐츠를 3개 선택하세요!</h1>\n                <p>회원님이 좋아하실 만한 영화를 더 많이 추천해드릴 수 있습니다. 마음에 드는 콘텐츠를 선택하세요.<br/><Link to={'/search'}> 알아서 볼게요!! &lt; Click</Link></p>\n            </div>\n            <div className='movie-list'>\n                <DropdownButton id=\"dropdown-item-button\" title={genreValue ? genre[genreValue-1] :\"장르를 선택하세요\"}>\n                    {genre.map(function(j){\n                        return <Link><Dropdown.Item onClick={(e)=>{FindGenreValue(e,j)}}>{j}</Dropdown.Item></Link>\n                    })}\n                </DropdownButton>\n                <div className='row ml-0 mt-1 mb-1'>\n                    {checkedMovie.map((movie, i) =>(                    \n                        <Card style={{ width: '33.3%', display: 'inline-block' }}>\n                            <Card.Img variant=\"top\" src={movie.movie_poster} height='200px'/>\n                            <Card.Body>\n                                <Card.Title>{movie.movie_title}</Card.Title>\n                                <Card.Text>\n                                    {movie.movie_content.substr(0, 90)}\n                                    {movie.movie_content.length > 90 ? '...' : ''}\n                                </Card.Text>\n                                <Button variant=\"outline-primary\" className=\"mr-1\" onClick={() => props.history.push('/'+movie.movie_id)}>바로보기</Button>\n                                <Button variant=\"outline-danger\" onClick={() => handleClickCancle(i)}>선택취소</Button>\n                            </Card.Body>\n                        </Card>\n                    ))}\n                </div>\n                {checkedMovie.length === 3 ?\n                <button className='btn clickrecomm' onClick={handleClickSearch}>내 취향에 맞게 추천받기!</button>:\n                <button className='btn clickrecomm_disable disable' onClick={() => alert('영화 '+(3-checkedMovie.length)+'개를 더 선택해야합니다.')}>내 취향에 맞게 추천받기!</button>\n                }\n                <div className='row'>\n                    <div className='movieposter'>\n                        {genreFilter(movies).map((movie, i)=>(\n                            <img className='img-responsive' src={movie.movie_poster} alt={i} onClick={() => { handleClickImage(movie); }}/>\n                        ))}  \n                    </div>     \n                </div>\n                \n            </div>\n            </>}\n        </div>\n    )\n};\n\nexport default withRouter(MainPresenter);\n"]},"metadata":{},"sourceType":"module"}